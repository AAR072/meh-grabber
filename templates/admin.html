<!DOCTYPE html>
<html>
<head>
    <title>Logger Admin</title>
    <style>
        body { font-family: sans-serif; max-width: 800px; margin: auto; padding: 20px; background: #f4f4f4; }
        .card { background: white; padding: 20px; margin-bottom: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        input, select, textarea { width: 100%; margin-bottom: 10px; padding: 8px; box-sizing: border-box; }
        textarea { height: 100px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 10px; border-bottom: 1px solid #ddd; text-align: left; }
        .btn-del { color: red; text-decoration: none; }

        /* Toggle Styles */
        .smart-options { display: none; padding: 10px; background: #eef; border-radius: 5px; margin-bottom: 10px;}
        .checkbox-wrapper { display: flex; align-items: center; margin-bottom: 10px; }
        .checkbox-wrapper input { width: auto; margin-right: 10px; margin-bottom: 0;}
    </style>
    <script>
        function toggleSmartOptions() {
            var checkbox = document.getElementById('smartToggle');
            var optionsDiv = document.getElementById('smartOptionsDiv');
            if (checkbox.checked) {
                optionsDiv.style.display = 'block';
            } else {
                optionsDiv.style.display = 'none';
            }
        }
    </script>
</head>
<body>
    <h1>Admin Control</h1>
    <a href="/admin/logout">Logout</a>

    <div class="card">
        <h3>Add New Route</h3>
        <form action="/admin/add" method="post">
            <input type="text" name="path" placeholder="Path (e.g. birthday)" required>

            <select name="type">
                <option value="redirect">Redirect URL</option>
                <option value="html">Custom HTML Code</option>
            </select>

            <div class="checkbox-wrapper">
                <input type="checkbox" id="smartToggle" name="is_smart" onchange="toggleSmartOptions()">
                <label for="smartToggle"><strong>Enable Smart Logger (JS Fingerprint)</strong></label>
            </div>

            <div id="smartOptionsDiv" class="smart-options">
                <label>Fake Page Title (Visible in browser tab):</label>
                <input type="text" name="page_title" placeholder="Loading...">
                <small>The page will be blank/black. This title appears in the tab.</small>
            </div>

            <textarea name="content" placeholder="Destination URL (if redirect) OR Raw HTML..." required></textarea>
            <button type="submit">Save Route</button>
        </form>
    </div>

    <div class="card">
        <h3>Active Routes</h3>
        <table>
            <tr>
                <th>Path</th>
                <th>Type</th>
                <th>Smart?</th>
                <th>Action</th>
            </tr>
            {% for route in routes %}
            <tr>
                <td>/{{ route['path'] }}</td>
                <td>{{ route['type'] }}</td>
                <td>{{ '✅' if route['is_smart'] else '❌' }}</td>
                <td><a href="/admin/delete/{{ route['path'] }}" class="btn-del">Delete</a></td>
            </tr>
            {% endfor %}
        </table>
    </div>
</body>
</html>
